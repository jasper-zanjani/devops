
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jasper-zanjani.github.io/devops/Ansible/">
      
      
        <link rel="prev" href="../ADO/">
      
      
        <link rel="next" href="../github/">
      
      
      <link rel="icon" href="../favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Ansible - DevOps</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M512%2080c0%2018-14.3%2034.6-38.4%2048-29.1%2016.1-72.5%2027.5-122.3%2030.9-3.7-1.8-7.4-3.5-11.3-5-39.4-16.5-91.8-25.9-148-25.9-8.3%200-16.4.2-24.5.6l-1.1-.6C142.3%20114.6%20128%2098%20128%2080c0-44.2%2086-80%20192-80s192%2035.8%20192%2080m-351.3%2081.1c10.2-.7%2020.7-1.1%2031.3-1.1%2062.2%200%20117.4%2012.3%20152.5%2031.4%2024.8%2013.5%2039.5%2030.3%2039.5%2048.6q0%206-2.1%2011.7c-4.6%2013.2-17%2025.3-35%2035.5-.1.1-.3.1-.4.2-.3.2-.6.3-.9.5-35%2019.4-90.8%2032-153.6%2032-59.6%200-112.9-11.3-148.2-29.1-1.9-.9-3.7-1.9-5.5-2.9C14.3%20274.6%200%20258%200%20240c0-34.8%2053.4-64.5%20128-75.4%2010.5-1.5%2021.4-2.7%2032.7-3.5M416%20240c0-21.9-10.6-39.9-24.1-53.4%2028.3-4.4%2054.2-11.4%2076.2-20.5%2016.3-6.8%2031.5-15.2%2043.9-25.5V176c0%2019.3-16.5%2037.1-43.8%2050.9-14.6%207.4-32.4%2013.7-52.4%2018.5.1-1.8.2-3.5.2-5.3zm-32%2096c0%2018-14.3%2034.6-38.4%2048-1.8%201-3.6%201.9-5.5%202.9C304.9%20404.7%20251.6%20416%20192%20416c-62.8%200-118.6-12.6-153.6-32C14.3%20370.6%200%20354%200%20336v-35.4c12.5%2010.3%2027.6%2018.7%2043.9%2025.5C83.4%20342.6%20135.8%20352%20192%20352s108.6-9.4%20148.1-25.9c7.8-3.2%2015.3-6.9%2022.4-10.9%206.1-3.4%2011.8-7.2%2017.2-11.2%201.5-1.1%202.9-2.3%204.3-3.4V336m32%200v-57.9c19-4.2%2036.5-9.5%2052.1-16%2016.3-6.8%2031.5-15.2%2043.9-25.5V272c0%2010.5-5%2021-14.9%2030.9-16.3%2016.3-45%2029.7-81.3%2038.4.1-1.7.2-3.5.2-5.3M192%20448c56.2%200%20108.6-9.4%20148.1-25.9%2016.3-6.8%2031.5-15.2%2043.9-25.5V432c0%2044.2-86%2080-192%2080S0%20476.2%200%20432v-35.4c12.5%2010.3%2027.6%2018.7%2043.9%2025.5C83.4%20438.6%20135.8%20448%20192%20448%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22m7.775%203.275%201.25-1.25a3.5%203.5%200%201%201%204.95%204.95l-2.5%202.5a3.5%203.5%200%200%201-4.95%200%20.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%202%202%200%200%200%202.83%200l2.5-2.5a2.002%202.002%200%200%200-2.83-2.83l-1.25%201.25a.75.75%200%200%201-1.042-.018.75.75%200%200%201-.018-1.042m-4.69%209.64a2%202%200%200%200%202.83%200l1.25-1.25a.75.75%200%200%201%201.042.018.75.75%200%200%201%20.018%201.042l-1.25%201.25a3.5%203.5%200%201%201-4.95-4.95l2.5-2.5a3.5%203.5%200%200%201%204.95%200%20.75.75%200%200%201-.018%201.042.75.75%200%200%201-1.042.018%202%202%200%200%200-2.83%200l-2.5%202.5a2%202%200%200%200%200%202.83%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ansible" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DevOps" class="md-header__button md-logo" aria-label="DevOps" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DevOps
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ansible
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DevOps" class="md-nav__button md-logo" aria-label="DevOps" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    DevOps
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automation using Azure DevOps and Ansible
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Devops
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Ansible
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Ansible
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loops" class="md-nav__link">
    <span class="md-ellipsis">
      Loops
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      Jinja2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roles" class="md-nav__link">
    <span class="md-ellipsis">
      Roles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    <span class="md-ellipsis">
      Collections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Handlers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vault" class="md-nav__link">
    <span class="md-ellipsis">
      Vault
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache" class="md-nav__link">
    <span class="md-ellipsis">
      Apache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    <span class="md-ellipsis">
      Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-creation" class="md-nav__link">
    <span class="md-ellipsis">
      User creation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    <span class="md-ellipsis">
      Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible-galaxy" class="md-nav__link">
    <span class="md-ellipsis">
      ansible-galaxy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Glossary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/gcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google Cloud Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AWS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            AWS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/ebs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EBS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/ec2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EC2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/iam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/AWS/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/ARM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-Backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-File-Service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure File Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-IAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure IAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-IaaS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure IaaS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-Key-Vault/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Key Vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-Monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-Policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-Storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Azure-VPN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure VPN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/Kusto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kusto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/appservice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Appservice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/Azure/entra-id/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entra id
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    IBM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            IBM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud/IBM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IBM Cloud
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kubernetes/helm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Terraform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2_1" >
        
          
          <label class="md-nav__link" for="__nav_7_2_1" id="__nav_7_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AWS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_1">
            <span class="md-nav__icon md-icon"></span>
            AWS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/AWS/create-user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create user
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/AWS/deploy-vm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy VM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/AWS/eks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2_2" id="__nav_7_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_2">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/Azure/00-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    provider
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/Azure/01-group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    azurerm_resource_group
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/Azure/10-vnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    azurerm_virtual_network
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2_3" >
        
          
          <label class="md-nav__link" for="__nav_7_2_3" id="__nav_7_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_3">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/Basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello, World!
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2_4" >
        
          
          <label class="md-nav__link" for="__nav_7_2_4" id="__nav_7_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    IBM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_4">
            <span class="md-nav__icon md-icon"></span>
            IBM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Terraform/Tasks/IBM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IBM Cloud tasks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ansible">Ansible</h1>
<details class="info">
<summary>Projects for learning</summary>
<p>There are [several areas][https://opensource.com/article/19/8/ops-tasks-ansible] where Ansible can be used in personal projects for learning purposes. </p>
<ol>
<li>Use the <a href="#users"><strong>users</strong></a> module to manage users, assign groups, and define custom aliases in the <code>profile</code> property.</li>
<li>Put a time limit on the availability of the <code>sudo</code> command</li>
<li>Use Ansible Tower to produce a GUI interface to restart certain services.</li>
<li>Use Ansible Tower to look for files larger than a particular size in a directory.</li>
<li>Debug a system performance problem. </li>
</ol>
</details>
<p><strong>Ansible</strong> is an automation tool used for configuration management using human-readable YAML templates. 
Ansible is distinguished for being <strong>agentless</strong>, meaning no special software is required on the nodes it manages.</p>
<p>Ansible can be used in one of two ways:</p>
<ul>
<li>Running <strong id="ad-hoc">ad hoc commands</strong>, executed in realtime by an administrator working at the terminal using the <a href="#ansible"><strong>ansible</strong></a> command</li>
<li>Running <strong>playbooks</strong>, YAML documents that represent a sequence of scripted actions which apply changes uniformly over a set of hosts, using the <a href="#ansible-playbook"><strong>ansible-playbook</strong> </a> command. </li>
</ul>
<p>A <strong id="playbook">playbook</strong> is a YAML document that represents a sequence of scripted actions called <strong id="task">tasks</strong> which apply changes uniformly over a set of hosts.
Any ad hoc command can be rewritten as a playbook, but some modules can only be used effectively as playbooks.</p>
<div class="highlight"><span class="filename">playbooks/motd.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="nv"> </span><span class="s">World!&quot;</span>
</code></pre></div>
<p>Ansible host management relies on an <a href="https://docs.ansible.com/ansible/latest/getting_started/get_started_inventory.html#building-an-inventory" id="inventory"><strong>inventory</strong></a> file, an INI or YAML format file containing a list of servers or nodes that can be organized in groups.
Inventories are conventionally organized as a file named <strong>hosts</strong> at the root of a project directory, although a system hosts file can also be defined at <strong>/etc/ansible/hosts</strong>.</p>
<h4 id="variables">Variables</h4>
<p><a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html"><strong>Variables</strong></a> can be defined under <strong>vars</strong> (as properties), and they are <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#referencing-simple-variables">referenced</a> using Jinja2-style double braces: <strong>{{ }}</strong>. 
YAML syntax requires a value starting with double braces to be quoted.</p>
<div class="highlight"><span class="filename">playbooks/motd.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="hll"><span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
</span><span class="hll"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">World</span>
</span><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, {{ name }}!&quot;</span>
</code></pre></div>
<p>Variables can also be defined in <strong>variables files</strong>, YAML-format dictionaries conventionally placed in the <strong>vars</strong> directory, and referenced using the <strong>vars_files</strong> property.
The path for vars files appears to be interpreted relative to the location of the playbook.</p>
<p><div class="highlight"><span class="filename">playbooks/motd.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="hll"><span class="w">  </span><span class="nt">vars_files</span><span class="p">:</span>
</span><span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vars/name.yml</span>
</span><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello, {{ greet_name }}!</span>
</code></pre></div>
<div class="highlight"><span class="filename">playbooks/vars/name.yml</span><pre><span></span><code><span class="nt">greet_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">World</span>
</code></pre></div></p>
<p>Variables can also be defined at runtime using the <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#defining-variables-at-runtime" id="extra-vars"><strong>--extra-vars</strong>/<strong>-e</strong></a> option.
Variables can be passed as space-delimited or JSON format.</p>
<div class="highlight"><pre><span></span><code>ansible-playbook<span class="w"> </span>release.yml<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;version=1.23.45 other_variable=foo&quot;</span>
</code></pre></div>
<p>Variables cane be <a href="https://docs.ansible.com/ansible/2.9/user_guide/playbooks_vault.html#single-encrypted-variable">encrypted inline</a> in an otherwise cleartext vars file.</p>
<h4 id="loops">Loops</h4>
<p>Here is an unusual example of a loop that uses the control variable to successively delete, then create a directory</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Regen Kickstart dir</span>
<span class="w">  </span><span class="nt">file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">isopath</span><span class="nv"> </span><span class="s">}}/ks&quot;</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">stmp</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">loop</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">directory</span>
<span class="w">  </span><span class="nt">loop_control</span><span class="p">:</span>
<span class="w">    </span><span class="nt">loop_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stmp</span>
</code></pre></div>
<h4 id="jinja2">Jinja2</h4>
<p>Various effects are possible using Jinja2 templates:</p>
<p>Jinja2 <strong>control structures</strong> support control flow features like loops and conditionals inside <strong>{% ... %}</strong> blocks.</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find any YUM/DNF variables</span>
<span class="w">  </span><span class="nt">find</span><span class="p">:</span>
<span class="hll"><span class="w">    </span><span class="nt">paths</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/etc/{%</span><span class="nv"> </span><span class="s">&#39;dnf&#39;</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">ansible_distribution_major_version</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">&#39;8&#39;</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">&#39;yum&#39;</span><span class="nv"> </span><span class="s">%}/vars&quot;</span>
</span><span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_repository_vars_files</span>
</code></pre></div>
<p><a href="https://jinja.palletsprojects.com/en/latest/templates/#filters">Filters</a> follow a pipe in the template.</p>
<div class="highlight"><span class="filename">Capitalize a value</span><pre><span></span><code><span class="nt">line</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">hypervisor</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">upper</span><span class="nv"> </span><span class="s">}}</span>
</code></pre></div>
<p>Ansible provides <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html#filter-plugins">additional filters</a>.
Here both the <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/basename_filter.html#ansible-collections-ansible-builtin-basename-filter">basename</a>, <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/b64decode_filter.html#ansible-collections-ansible-builtin-b64decode-filter">b64decode</a>, and <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/combine_filter.html#ansible-collections-ansible-builtin-combine-filter">combine</a> Ansible filters are used as well as <a href="https://jinja.palletsprojects.com/en/latest/templates/#jinja-filters.trim">trim</a> which is native to Jinja2.
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">set_fact</span><span class="p">:</span>
<span class="hll"><span class="w">    </span><span class="nt">repository_vars</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">(repository_vars</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">default({}))</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">combine({</span><span class="nv"> </span><span class="s">(_file.source</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">basename):</span><span class="nv"> </span><span class="s">_file.content</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">b64decode</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">trim</span><span class="nv"> </span><span class="s">})</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span class="w">  </span><span class="nt">loop</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">_repository_vars_slurped_files.results</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">loop_control</span><span class="p">:</span>
<span class="w">    </span><span class="nt">loop_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_file</span>
</code></pre></div></p>
<h4 id="roles">Roles</h4>
<p>Ansible <strong id="role">roles</strong> group content in a way that allows it to be shared.
They typically correspond to the service offered (web servers or databases, etc).</p>
<p>Roles have a highly standardized directory structure.</p>
<ul>
<li><strong>defaults</strong>: default values for variables with low perecedence that <strong>can</strong> be overriden by inventory variables</li>
<li><strong>files</strong>: static files referenced by role tasks</li>
<li><strong>handlers</strong>: handler definitions</li>
<li><strong>meta</strong>: metadata about the role, such as author, license, platforms, dependencies, etc</li>
<li><strong>tasks</strong>: task definitions</li>
<li><strong>vars</strong>: role variables with high precedence that <strong>cannot</strong> be overriden by inventory variables</li>
</ul>
<p>A skeleton directory can be created with <a href="#ansible-galaxy">ansible-galaxy</a>. </p>
<div class="highlight"><pre><span></span><code>ansible-galaxy<span class="w"> </span>init<span class="w"> </span><span class="nv">$ROLENAME</span>
</code></pre></div>
<p>Roles can be called in a playbook under the <strong>roles</strong> property.
The value of the role is interpreted as a path, appended to the project directory or various other potential locations. Because roles are meant to be reused by many playbooks, a central location is recommended:</p>
<ul>
<li>~/.ansible/roles</li>
<li>/etc/ansible/roles</li>
<li>/usr/share/ansible/roles</li>
</ul>
<div class="highlight"><span class="filename">playbooks/motd.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">roles/motd</span>
<span class="w">    </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">      </span><span class="nt">greet_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dgiapusccu</span><span class="w"> </span><span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>Without providing an overriding variable value:
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">roles/motd</span>
</code></pre></div></li>
</ol>
<div class="highlight"><span class="filename">motd role</span><pre><span></span><code><span class="c1"># motd/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello, {{ greet_name }}!</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>

<span class="c1"># motd/defaults/main.yml</span>
<span class="nt">greet_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">World</span><span class="w"> </span><span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>Role variables defined in <strong>vars</strong> have a high precedence and cannot be overriden.
Only values defined in <strong>defaults</strong> can be overriden.</li>
</ol>
<p>It appears that variables with values defined in the main.yml file located <strong>vars</strong> or <strong>defaults</strong> are automatically picked up.
But if variables are defined in additional files they must be explicitly imported.</p>
<div class="highlight"><span class="filename">motd/tasks/main.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">include_vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">role_path</span><span class="nv"> </span><span class="s">}}/defaults/secure.yml&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello, {{ greet_name }}!</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
</code></pre></div>
<p>Normally, tasks in a role execute <strong>before</strong> the other tasks of a playbook. <strong>pre_tasks</strong> and <strong>post_tasks</strong> can be defined as well. </p>
<p>Roles can have dependencies on other dependencies, as defined in the <strong>meta</strong> directory.</p>
<div class="highlight"><pre><span></span><code><span class="nt">dependencies</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> role</span><span class="p">:</span><span class="w"> </span><span class="nv">apache</span><span class="p p-Indicator">,</span><span class="nt"> port</span><span class="p">:</span><span class="w"> </span><span class="nv">80</span><span class="w"> </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> role</span><span class="p">:</span><span class="w"> </span><span class="nv">mariadb</span><span class="p p-Indicator">,</span><span class="nt"> dbname</span><span class="p">:</span><span class="w"> </span><span class="nv">addresses</span><span class="p p-Indicator">,</span><span class="nt"> admin_user</span><span class="p">:</span><span class="w"> </span><span class="nv">bob</span><span class="w"> </span><span class="p p-Indicator">}</span>
</code></pre></div>
<h4 id="collections">Collections</h4>
<p>Ansible <a href="https://www.youtube.com/watch?v=WOcqhk7TdYc"><strong>collections</strong></a> comprise a standardized format for <strong>Ansible content</strong> distribution, allowing it to be delivered asynchronously and on-demand separately from Ansible Automation Platform releases.
Ansible content can include playbooks, modules, roles, documentation, tests, plugins.
Ansible collections are delivered using <strong>Ansible Galaxy</strong> and each collection needs a galaxy.yml file that describes the collection.</p>
<p>Collections can be installed from a YAML-format requirements file:</p>
<div class="highlight"><pre><span></span><code>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>ansible/requirements.yml
</code></pre></div>
<div class="highlight"><span class="filename">ansible/requirements.yml</span><pre><span></span><code><span class="nt">roles</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git@ssh.dev.azure.com:v3/PODS-LLC/SWE/devops_inventory_role</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">master</span><span class="w"> </span><span class="c1"># (2)</span>
<span class="w">  </span><span class="nt">scm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inventory</span><span class="w"> </span><span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>This apparently determines how the directory is renamed.</li>
<li>Branch name</li>
</ol>
<h4 id="handlers">Handlers</h4>
<p><strong>Handlers</strong> are tasks that are executed when notified by a task. They are only run once, and only if the notifying task has made a change to the system. </p>
<p>Here, <strong>Enable Apache</strong> will be called if <strong>Install Apache</strong> makes a change. 
If apache2 is already installed, the handler is not called. </p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webservers</span>
<span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Apache</span>
<span class="w">    </span><span class="nt">apt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name=apache2 update_cache=yes state=latest</span>
<span class="w">    </span><span class="nt">notify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable apaches</span>

<span class="w">  </span><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Enable Apache</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name=apache2 enabled=yes state=started</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">package_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apache2</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">this installs a package</span>
<span class="w">    </span><span class="nt">apt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;name={{</span><span class="nv"> </span><span class="s">package_name</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">update_cache=yes</span><span class="nv"> </span><span class="s">state=latest&quot;</span>
<span class="w">    </span><span class="nt">notify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable apache</span>
<span class="w">  </span><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable apache</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;name={{</span><span class="nv"> </span><span class="s">package_name</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">enabled=yes</span><span class="nv"> </span><span class="s">state=started&quot;</span><span class="w"> </span>
</code></pre></div>
<p><strong>Conditional logic</strong> is <a href="https://www.linuxjournal.com/content/ansible-part-iii-playbooks">implemented</a> on each task by defining a value for the <strong>when</strong> statement:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">startme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo Hello, World!</span>
<span class="w">    </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">startme</span>
</code></pre></div>
<h4 id="vault">Vault</h4>
<p><strong>Ansible Vault</strong> is a place to safely keep passwords.
There are two types of vaulted content:</p>
<ul>
<li><strong>Vaulted files</strong>, where the full file, which can contain Ansible variables or other content, is encrypted</li>
<li><strong>Single encrypted variables</strong>, where only specific variables within a normal "variable file" are encrypted.</li>
</ul>
<div class="highlight"><span class="filename">Run a playbook providing a vault password file</span><pre><span></span><code>ansible-playbook<span class="w"> </span>--vault-password-file<span class="w"> </span><span class="nv">$pwfile</span><span class="w"> </span>playbooks/motd.yml
</code></pre></div>
<h2 id="tasks">Tasks</h2>
<h4 id="setup">Setup</h4>
<dl>
<dd>
<p>The Ansible <strong>control node</strong> needs to be configured to elevate privileges.
This is done by modifying <strong>ansible.cfg</strong> in the relevant project directory or the system config at <strong>/etc/ansible/ansible.cfg</strong></p>
<div class="highlight"><span class="filename">ansible.cfg</span><pre><span></span><code><span class="k">[privilege_escalation]</span>
<span class="na">become</span><span class="o">=</span><span class="s">yes</span>
</code></pre></div>
<p>An Ansible service account is created on each <strong>managed node</strong>.</p>
<div class="highlight"><pre><span></span><code>useradd<span class="w"> </span>ansible<span class="w"> </span>-s<span class="w"> </span>/usr/bin/bash<span class="w"> </span>-mG<span class="w"> </span>wheel<span class="w"> </span><span class="c1"># sudo</span>
passwd<span class="w"> </span>ansible
su<span class="w"> </span>-<span class="w"> </span>ansible
ssh-keygen<span class="w"> </span>-A
</code></pre></div>
<p>Now the service account is given the ability to sudo any command without a password.</p>
<div class="highlight"><span class="filename">/etc/sudoers.d/ansible</span><pre><span></span><code><span class="c1"># Without this line, plays will fail with the message &quot;Missing sudo password&quot; </span>
ansible<span class="w"> </span><span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span><span class="w"> </span>NOPASSWD:<span class="w"> </span>ALL
</code></pre></div>
<p>The system inventory is an INI-format config located at <strong>etc/ansible/hosts</strong> and defines the clients which are to be controlled by the server.</p>
<p>The group name <strong>all</strong> is implicitly defined, and the following command will display all defined hosts.</p>
<div class="highlight"><span class="filename">Display all available hosts</span><pre><span></span><code>ansible<span class="w"> </span>all<span class="w"> </span>--list-hosts
</code></pre></div>
</dd>
</dl>
<h4 id="apache">Apache</h4>
<dl>
<dd>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">package</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">httpd</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">service</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">httpd</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ansible.posix.firewalld</span><span class="p">:</span>
<span class="w">      </span><span class="nt">immediate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">permanent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enabled</span>
</code></pre></div>
<p id="httpd-vars"><div class="highlight"><span class="filename">Using vars</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Apache</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="hll"><span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
</span><span class="hll"><span class="w">    </span><span class="nt">apache_package</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">httpd</span>
</span><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install {{ apache_package }} package</span>
<span class="w">    </span><span class="nt">package</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">apache_package</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Enable and start {{ apache_package }} service</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">apache_package</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Open firewall</span>
<span class="w">    </span><span class="nt">ansible.posix.firewalld</span><span class="p">:</span>
<span class="w">      </span><span class="nt">immediate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">permanent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enabled</span>
</code></pre></div></p>
</dd>
</dl>
<h4 id="files">Files</h4>
<dl>
<dd>
<div class="highlight"><span class="filename">Create file</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
<span class="w">  </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="nv"> </span><span class="s">World!\n&quot;</span><span class="w"> </span><span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>Alma Linux 9 additionally requires the <strong>libselinux-python</strong> package to handle SELinux contexts. It is incorrectly identified as "libselinux-python" in the Ansible error message.</li>
</ol>
<div class="highlight"><span class="filename">Delete file</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
<span class="w">  </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
</code></pre></div>
<div class="highlight"><span class="filename">Create directory</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/ansible/.vim/autoload</span>
<span class="w">  </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">directory</span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0755</span>
</code></pre></div>
</dd>
</dl>
<h4 id="user-creation">User creation</h4>
<dl>
<dd>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">newuser</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">}}&quot;</span>
</code></pre></div>
<p>More secure is using a separate vaulted variables file to keep the credential secure.</p>
<p><div class="highlight"><span class="filename">playbooks/user.yml</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">vars_files</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vars/user.yml</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">}}&quot;</span>
</code></pre></div>
<div class="highlight"><span class="filename">playbooks/vars/user.yml</span><pre><span></span><code><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">newuser</span>
<span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</code></pre></div>
<div class="highlight"><span class="filename">Run playbook providing a password file</span><pre><span></span><code>ansible-playbook<span class="w"> </span>--vault-password-file<span class="w"> </span>vault-pw<span class="w"> </span>playbooks/user.yml
</code></pre></div></p>
</dd>
</dl>
<h2 id="commands">Commands</h2>
<div class="highlight"><span class="filename">ansible</span><pre><span></span><code><span class="c1"># Ad-hoc commands&quot;</span>
ansible<span class="w"> </span>all<span class="w"> </span>-m<span class="w"> </span>shell<span class="w"> </span>-a<span class="w"> </span>env

<span class="c1"># The **command** module is default and does not have to be made explicit</span>
ansible<span class="w"> </span>all<span class="w"> </span>-a<span class="w"> </span>env<span class="w"> </span><span class="c1"># (1)</span>

<span class="c1"># Delineate hosts</span>
ansible<span class="w"> </span>all<span class="w"> </span>--list-hosts

<span class="c1"># Display specific groups from a provided inventory</span>
ansible<span class="w"> </span>--list-hosts<span class="w"> </span>rhel7:rhel8<span class="w"> </span>-i<span class="w"> </span>pods/inventory_role/pd/hosts
</code></pre></div>
<div class="highlight"><span class="filename">ansible-config</span><pre><span></span><code><span class="c1"># Display non-default settings</span>
ansible-config<span class="w"> </span>dump<span class="w"> </span>--only-changed
</code></pre></div>
<div class="highlight"><span class="filename">ansible-doc</span><pre><span></span><code><span class="c1"># List currently installed modules</span>
ansible-doc<span class="w"> </span>-l

<span class="c1"># Get module-specific information</span>
ansible-doc<span class="w"> </span><span class="nv">$MODULE</span>

<span class="c1"># Get example code</span>
ansible-doc<span class="w"> </span>-s<span class="w"> </span><span class="nv">$MODULE</span>
</code></pre></div>
<div class="highlight"><span class="filename">ansible-playbook</span><pre><span></span><code><span class="c1"># Verify YAML syntax</span>
ansible-playbook<span class="w"> </span>--syntax-check<span class="w"> </span><span class="nv">$FILE</span>
</code></pre></div>
<div class="highlight"><span class="filename">ansible-vault</span><pre><span></span><code><span class="c1"># Create an encrypted file, providing password interactively</span>
ansible-vault<span class="w"> </span>create<span class="w"> </span><span class="nv">$file</span>

<span class="c1"># Use a cleartext password file</span>
ansible-vault<span class="w"> </span>view<span class="w"> </span>--vault-password-file<span class="o">=</span>vault-pw<span class="w"> </span><span class="nv">$file</span>

<span class="c1"># Encrypt/decrypt a file in-place, overwriting original file</span>
ansible-vault<span class="w"> </span>encrypt<span class="w"> </span><span class="nv">$file</span>
ansible-vault<span class="w"> </span>decrypt<span class="w"> </span><span class="nv">$file</span>

ansible-vault<span class="w"> </span>edit<span class="w"> </span>secret.yml
</code></pre></div>
<h4 id="ansible-galaxy">ansible-galaxy</h4>
<dl>
<dd></dd>
</dl>
<h2 id="modules">Modules</h2>
<div class="highlight"><span class="filename">apt</span><pre><span></span><code><span class="c1"># devops_solarwinds_role</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install apt-transport-https</span>
<span class="w">  </span><span class="nt">apt</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apt-transport-https</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_distribution == &#39;Debian&#39; or ansible_distribution == &#39;Ubuntu&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run update for apt</span>
<span class="w">  </span><span class="nt">apt</span><span class="p">:</span>
<span class="w">    </span><span class="nt">update_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_distribution == &#39;Debian&#39; or ansible_distribution == &#39;Ubuntu&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install swiagent for apt</span>
<span class="w">  </span><span class="nt">apt</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swiagent</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">perl</span>
<span class="w">      </span><span class="c1"># - linux-tools</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_distribution == &#39;Debian&#39; or ansible_distribution == &#39;Ubuntu&#39;</span>
</code></pre></div>
<div class="highlight"><span class="filename">archive</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Compress directory /path/to/foo/ into /path/to/foo.tgz</span>
<span class="w">  </span><span class="nt">archive</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/foo</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/foo.tgz</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create a bz2 archive of multiple files, rooted at /path</span>
<span class="w">  </span><span class="nt">archive</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/foo</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/wong/foo</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/file.tar.bz2</span>
<span class="w">    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bz2</span>
</code></pre></div>
<div class="highlight"><span class="filename">cli_config</span><pre><span></span><code><span class="c1"># Platform-agnostic way of pushing text-based configurations to network devices over the network_cli_connection plugin.</span>
<span class="c1"># Source: https://opensource.com/article/19/9/must-know-ansible-modules</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set hostname for a switch and exit with a commit message</span>
<span class="w">  </span><span class="nt">cli_config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set system host-name foo</span>
<span class="w">    </span><span class="nt">commit_comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">this is a test</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Back up a config to a different destination file</span>
<span class="w">  </span><span class="nt">cli_config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">lookup(&#39;template&#39;,</span><span class="nv"> </span><span class="s">&#39;basic/config.j2&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">backup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">backup_options</span><span class="p">:</span>
<span class="w">      </span><span class="nt">filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backup.cfg</span>
<span class="w">      </span><span class="nt">dir_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/user</span>
</code></pre></div>
<div class="highlight"><span class="filename">command</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Return motd to registered var</span>
<span class="w">  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cat /etc/motd</span>
<span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mymotd</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Change the working directory to somedir/ and run the command as db_owner if /path/to/database does not exist.</span>
<span class="w">  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/make_database.sh db_user db_name</span>
<span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db_owner</span>
<span class="w">  </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="nt">chdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">somedir/</span>
<span class="w">    </span><span class="nt">creates</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/database</span>
</code></pre></div>
<div class="highlight"><span class="filename">copy</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy a new &quot;ntp.conf file into place, backing up the original if it differs from the copied version</span>
<span class="w">  </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/mine/ntp.conf</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/ntp.conf</span>
<span class="w">    </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0644&#39;</span>
<span class="w">    </span><span class="nt">backup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy file with owner and permission, using symbolic representation</span>
<span class="w">  </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/srv/myfiles/foo.conf</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/foo.conf</span>
<span class="w">    </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">u=rw,g=r,o=r</span>
</code></pre></div>
<div class="highlight"><span class="filename">debug</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Display all variables/facts known for a host</span>
<span class="w">  </span><span class="nt">debug</span><span class="p">:</span>
<span class="w">    </span><span class="nt">var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostvars[inventory_hostname]</span>
<span class="w">    </span><span class="nt">verbosity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>

<span class="c1"># Display content of copy module only when verbosity of 2 is specified</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Write some content in a file /tmp/foo.txt</span>
<span class="w">  </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/foo.txt</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">Good Morning!</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">Awesome sunshine today.</span>
<span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">display_file_content</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug display_file_content</span>
<span class="w">  </span><span class="nt">debug</span><span class="p">:</span>
<span class="w">    </span><span class="nt">var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">display_file_content</span>
<span class="w">    </span><span class="nt">verbosity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</code></pre></div>
<div class="highlight"><span class="filename">file</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Change file ownership, group and permissions</span>
<span class="w">  </span><span class="nt">file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/foo.conf</span>
<span class="w">    </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0644&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create a directory if it does not exist</span>
<span class="w">  </span><span class="nt">file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/foo</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">directory</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0755&#39;</span>
</code></pre></div>
<div class="highlight"><span class="filename">file</span><pre><span></span><code><span class="c1"># Create a symlink</span>
ansible<span class="w"> </span><span class="nv">$CLIENT</span><span class="w"> </span>-b<span class="w"> </span>-m<span class="w"> </span>file<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;src=/etc/ntp.conf dest=/home/user/ntp.conf owner=user group=user state=link&quot;</span>

<span class="c1"># Create a folder using an ad hoc command</span>
ansible<span class="w"> </span><span class="nv">$CLIENT</span><span class="w"> </span>-b<span class="w"> </span>-m<span class="w"> </span>file<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;path=/etc/newfolder state=directory mode=0755&quot;</span>
</code></pre></div>
<div class="highlight"><span class="filename">firewalld</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/roles/cockpit_setup</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Permit the cockpit service</span>
<span class="w">  </span><span class="nt">ansible.posix.firewalld</span><span class="p">:</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cockpit</span>
<span class="w">    </span><span class="nt">permanent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">immediate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="w">    </span>
</code></pre></div>
<div class="highlight"><span class="filename">git</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">git</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create git archive from repo</span>
<span class="w">    </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/ansible/ansible-examples.git</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/src/ansible-examples</span>
<span class="w">    </span><span class="nt">archive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/ansible-examples.zip</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">git</span><span class="p">:</span>
<span class="w">    </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/ansible/ansible-examples.git</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/src/ansible-examples</span>
<span class="w">    </span><span class="nt">separate_git_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/src/ansible-examples.git</span>
</code></pre></div>
<div class="highlight"><span class="filename">group</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/roles/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure group &quot;docker&quot; exists</span>
<span class="w">  </span><span class="nt">group</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">    </span><span class="nt">system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</code></pre></div>
<div class="highlight"><span class="filename">ini_file</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Syncronize &quot;simple_allow_users&quot;</span>
<span class="w">  </span><span class="nt">community.general.ini_file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/sssd/sssd.conf</span>
<span class="w">    </span><span class="nt">section</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">default_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple_allow_users</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{%</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">ag</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">(ad[&#39;allowedusers&#39;]</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">default([]))</span><span class="nv"> </span><span class="s">%}{{</span><span class="nv"> </span><span class="s">ag.name</span><span class="nv"> </span><span class="s">}}{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">loop.last</span><span class="nv"> </span><span class="s">%},</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}{%</span><span class="nv"> </span><span class="s">endfor</span><span class="nv"> </span><span class="s">%}&quot;</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0600&#39;</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">    </span><span class="nt">exclusive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(ad[&#39;allowedusers&#39;]</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">default([]))</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">length&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove &quot;simple_allow_users&quot; when no users are listed</span>
<span class="w">  </span><span class="nt">community.general.ini_file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/sssd/sssd.conf</span>
<span class="w">    </span><span class="nt">section</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">default_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple_allow_users</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="nt">exclusive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;((ad[&#39;allowedusers&#39;]</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">default([]))</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">length)</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">1&quot;</span>
</code></pre></div>
<div class="highlight"><span class="filename">lineinfile</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure SELinux is set to enforcing mode</span>
<span class="w">  </span><span class="nt">lineinfile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/selinux/config</span>
<span class="w">    </span><span class="nt">regexp</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;^SELINUX=&#39;</span>
<span class="w">    </span><span class="nt">line</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SELINUX=enforcing</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add a line to a file if the file does not exist, without passing regexp</span>
<span class="w">  </span><span class="nt">lineinfile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/resolv.conf</span>
<span class="w">    </span><span class="nt">line</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.99 foo.lab.net foo</span>
<span class="w">    </span><span class="nt">create</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</code></pre></div>
<div class="highlight"><span class="filename">package</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Apache and MariaDB</span>
<span class="w">  </span><span class="nt">dnf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">httpd</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb-server</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install PostgreSQL and NGINX</span>
<span class="w">  </span><span class="nt">yum</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql-server</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</code></pre></div>
<div class="highlight"><span class="filename">redhat_subscription</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/subscribe_vm/roles/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Subscribe RHEL System with RedHat</span>
<span class="w">  </span><span class="nt">redhat_subscription</span><span class="p">:</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">rhsm[&#39;redhat_subscription_manager&#39;][&#39;username&#39;]</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">rhsm[&#39;redhat_subscription_manager&#39;][&#39;password&#39;]</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">auto_attach</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="c1"># force_register: &quot;{{ sm_status.stdout.find(&#39;Invalid&#39;) != -1 }}&quot;</span>
<span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subscribe_results</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_os_family == &#39;RedHat&#39; and ansible_distribution == &#39;RedHat&#39;</span>
</code></pre></div>
<div class="highlight"><span class="filename">replace</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Comment out a line in a config</span>
<span class="w">  </span><span class="nt">ansible.builtin.replace</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/motd</span>
<span class="w">    </span><span class="nt">regexp</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;^Hello,</span><span class="nv"> </span><span class="s">(.*)&#39;</span>
<span class="w">    </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#</span><span class="nv"> </span><span class="s">Hello,</span><span class="nv"> </span><span class="s">\1&#39;</span>
</code></pre></div>
<div class="highlight"><span class="filename">service</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Start service foo, based on running process /usr/bin/foo</span>
<span class="w">  </span><span class="nt">service</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">    </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/foo</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Restart network service for interface eth0</span>
<span class="w">  </span><span class="nt">service</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restarted</span>
<span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eth0</span>
</code></pre></div>
<div class="highlight"><span class="filename">setup</span><pre><span></span><code><span class="c1"># Display all available information about a system</span>
ansible<span class="w"> </span><span class="nv">$CLIENT</span><span class="w"> </span>-b<span class="w"> </span>-m<span class="w"> </span>setup

<span class="c1"># Filter results to ansible_os_family, which indicates if the OS is Debian or Red Hat</span>
ansible<span class="w"> </span><span class="nv">$CLIENT</span><span class="w"> </span>-b<span class="w"> </span>-m<span class="w"> </span>setup<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;filter=*family*&quot;</span>
</code></pre></div>
<div class="highlight"><span class="filename">shell</span><pre><span></span><code><span class="c1"># From PODS</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove Grub Defaults</span>
<span class="w">  </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">awk &#39;/### BEGIN \/etc\/grub.d\/10_linux ###/{stop=1} stop==0{print}&#39; &lt; ks/EFI/BOOT/grub.cfg &gt; grub.cfg</span>
<span class="w">    </span><span class="no">cat grub.cfg</span>
<span class="w">  </span><span class="nt">args</span><span class="p">:</span>
<span class="w">    </span><span class="nt">chdir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">isopath</span><span class="nv"> </span><span class="s">}}&quot;</span>
</code></pre></div>
<div class="highlight"><span class="filename">snap</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install VS Code</span>
<span class="w">  </span><span class="nt">snap</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">code</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">    </span><span class="nt">classic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span><span class="w">   </span>
</code></pre></div>
<div class="highlight"><span class="filename">systemd</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/roles/cockpit_setup/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Enable and start cockpit</span>
<span class="w">  </span><span class="nt">ansible.builtin.systemd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cockpit.socket</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>

<span class="c1"># pods.redhat_subscriptions/podman_setup/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Enable Podman socket</span>
<span class="w">  </span><span class="nt">systemd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">podman.socket</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restarted</span>
<span class="w">    </span><span class="nt">daemon_reload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<div class="highlight"><span class="filename">template</span><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install index</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">index.html.j2</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/www/html/index.html</span>
<span class="c1"># (1)!</span>

<span class="c1"># devops_solarwinds_role</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add mirrorlist</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">role_path</span><span class="nv"> </span><span class="s">}}/templates/swiagent-amzn-2015.mirrors.j2&quot;</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/yum.repos.d/swiagent-amzn-2015.mirrors</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_os_family == &quot;RedHat&quot;</span><span class="w">  </span>
<span class="c1"># (2)!</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add deb repo</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">role_path</span><span class="nv"> </span><span class="s">}}/templates/swiagent-ubuntu-14.list.j2&quot;</span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/etc/apt/sources.list.d/swiagent-ubuntu-14.list</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_distribution == &#39;Debian&#39; or ansible_distribution == &#39;Ubuntu&#39;</span>
<span class="c1"># (3)!</span>
</code></pre></div>
<ol>
<li><div class="highlight"><span class="filename">Jinja2 template file</span><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>This computer is running {{ ansible_os_family }},
  and its hostname is:<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>{{ ansible_hostname }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
  {# this is a comment, which won&#39;t be copied to the index.html file #}
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></li>
<li><div class="highlight"><pre><span></span><code>{% for host in groups[&#39;solarwinds&#39;] %}
https://{{ host }}/Orion/AgentManagement/LinuxPackageRepository.ashx?path=/dists/amzn-2015/$basearch
https://{{ host }}:443/Orion/AgentManagement/LinuxPackageRepository.ashx?path=/dists/amzn-2015/$basearch
{% endfor %}
</code></pre></div></li>
<li><div class="highlight"><pre><span></span><code>{% for host in groups[&#39;solarwinds&#39;] %}
deb [trusted=yes] https://{{ host }}/Orion/AgentManagement/LinuxPackageRepository.ashx?path= ubuntu-14 swiagent
deb [trusted=yes] https://{{ host }}:443/Orion/AgentManagement/LinuxPackageRepository.ashx?path= ubuntu-14 swiagent
{% endfor %}
</code></pre></div></li>
</ol>
<div class="highlight"><span class="filename">user</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/roles/podman_setup/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Add</span><span class="nv"> </span><span class="s">podman_nonroot_user</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">docker</span><span class="nv"> </span><span class="s">group&quot;</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">podman_nonroot_user</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker</span>
<span class="w">    </span><span class="nt">append</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">ignore_errors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</code></pre></div>
<div class="highlight"><span class="filename">yum</span><pre><span></span><code><span class="c1"># pods.redhat_subscriptions/roles/cockpit_setup/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Cockpit</span>
<span class="w">  </span><span class="nt">ansible.builtin.yum</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cockpit</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>

<span class="c1"># pods.redhat_subscriptions/roles/insights_setup/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup syncinsights package</span>
<span class="w">  </span><span class="nt">yum</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pods-syncinsights-el{{</span><span class="nv"> </span><span class="s">ansible_distribution_major_version</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">    </span><span class="nt">update_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;&#39;nexus&#39;</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">group_names&quot;</span>

<span class="c1"># devops_solarwinds_role/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install SolarWinds Agent</span>
<span class="w">  </span><span class="nt">yum</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swiagent</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">perl</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">perf</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_os_family == &quot;RedHat&quot;</span><span class="w">  </span>
</code></pre></div>
<div class="highlight"><span class="filename">yum_repository</span><pre><span></span><code><span class="c1"># devops_solarwinds_role/tasks/main.yml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add Solarwinds repository</span>
<span class="w">  </span><span class="nt">yum_repository</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swiagent</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SolarWinds Agent</span>
<span class="w">    </span><span class="nt">mirrorlist</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file:///etc/yum.repos.d/swiagent-amzn-2015.mirrors</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swiagent-amzn-2015</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">gpgcheck</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
<span class="w">  </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_os_family == &quot;RedHat&quot;</span><span class="w">  </span>
</code></pre></div>
<h2 id="glossary">Glossary</h2>
<ul>
<li><a href="#ad-hoc"><strong>Ad Hoc</strong></a>: type of command run in realtime by an administrator working at the terminal</li>
<li><strong>Ansible Galaxy</strong>: online portal where a gallery of roles made by the Ansible community can be found</li>
<li><strong>Ansible Tower</strong>: web-based RESTful API endpoint that provides the officially supported GUI frontend to Ansible configuration management, available in two versions: standard ($13,000/yr) and premium ($17,500/yr)</li>
<li><strong>Ansible Vault</strong>: place to keep encrypted passwords</li>
<li><strong>AWX</strong>: Open-source project upon which Ansible Tower was built</li>
<li><strong>Fact</strong>: System property gathered by Ansible when it executes a playbook on a node</li>
<li><a href="#modules"><strong>Module</strong></a>: standalone scripts that enable a particular task across many OSes, services, applications, etc. 
Predefined modules are available in the <strong>module library</strong>, and new ones can be defined via Python or JSON.</li>
<li><strong>Play</strong>: script or instruction that defines the task to be carried out in a server</li>
<li><strong>Role</strong>: organize components of playbooks, allowing them to be reused</li>
<li><a href="#task"><strong>Task</strong></a>: A single scripted action in a playbook, equivalent to an ad hoc command</li>
<li><a href="#vault"><strong>Vault</strong></a>: feature of Ansible that allows you to keep sensitive data such as passwords or keys protected at rest, rather than as plaintext in playbooks or roles.</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand", "toc.integrate", "content.code.annotate", "content.code.copy", "content.tabs.link"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>